<!DOCTYPE html>
<html lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    
      <title>
        Bumblebee ::
        Axelarator — A CTI Analyst Blog
      </title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="Bumblebee Sample # Bumblebee (Shindig) has been used by TA579 / BazaISO / Exotic Lily / Stolen Images to collect system information and exfil to a C2. Additional second-stage payloads include Cobalt Strike beacons.
https://bazaar.abuse.ch/sample/70eb84a6bce741ff988116434e4f531a724257185ab92df8fcfa90b3def6568f/
Download zip &amp;gt; .iso file (password protected)&amp;gt; dll/lnk inside
Once the ISO is mounted, the .dll and .lnk are visible.
LNK Analysis # Using LECmd.exe to analyze the LNK file. If on Linux, Lnkinfo gives a similar output."
/>
<meta
  name="keywords"
  content=""
/>
<meta name="robots" content="noodp" />
<link rel="canonical" href="http://localhost:1313/posts/bumblebee/" />







<link rel="stylesheet" href="/css/style.css" />

<link rel="stylesheet" href="http://localhost:1313/style.css" />


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:1313/img/apple-touch-icon-144-precomposed.png" />
<link rel="shortcut icon" href="http://localhost:1313/img/favicon.png" />


<link href="/fonts/Inter-Italic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-Regular.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-Medium.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-MediumItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-Bold.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-BoldItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">


<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Bumblebee"/>
<meta name="twitter:description" content="Bumblebee Sample # Bumblebee (Shindig) has been used by TA579 / BazaISO / Exotic Lily / Stolen Images to collect system information and exfil to a C2. Additional second-stage payloads include Cobalt Strike beacons.
https://bazaar.abuse.ch/sample/70eb84a6bce741ff988116434e4f531a724257185ab92df8fcfa90b3def6568f/
Download zip &gt; .iso file (password protected)&gt; dll/lnk inside
Once the ISO is mounted, the .dll and .lnk are visible.
LNK Analysis # Using LECmd.exe to analyze the LNK file. If on Linux, Lnkinfo gives a similar output."/>



<meta property="og:title" content="Bumblebee" />
<meta property="og:description" content="Bumblebee Sample # Bumblebee (Shindig) has been used by TA579 / BazaISO / Exotic Lily / Stolen Images to collect system information and exfil to a C2. Additional second-stage payloads include Cobalt Strike beacons.
https://bazaar.abuse.ch/sample/70eb84a6bce741ff988116434e4f531a724257185ab92df8fcfa90b3def6568f/
Download zip &gt; .iso file (password protected)&gt; dll/lnk inside
Once the ISO is mounted, the .dll and .lnk are visible.
LNK Analysis # Using LECmd.exe to analyze the LNK file. If on Linux, Lnkinfo gives a similar output." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/posts/bumblebee/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-25T16:35:18-04:00" />
<meta property="article:modified_time" content="2022-08-25T16:35:18-04:00" /><meta property="og:site_name" content="Axelarator" />






  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a
  href="/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >Axelarator</span
    >
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/projects">Projects</a></li>
        
      
      
      
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/projects">Projects</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none" />
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg
  class="theme-toggler"
  width="24"
  height="24"
  viewBox="0 0 48 48"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"
  />
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <article class="post">
    <h1 class="post-title">Bumblebee</h1>
    <div class="post-meta">
      
        <time class="post-date">
          2022-08-25
        </time>

        
          
        
      

      


      
    </div>

    

    

    <div class="post-content">
      
      <h1 id="bumblebee-sample">
  Bumblebee Sample
  <a href="#bumblebee-sample" class="h-anchor" aria-hidden="true">#</a>
</h1>
<p>Bumblebee (Shindig) has been used by TA579 / BazaISO / Exotic Lily / Stolen Images to collect system information and exfil to a C2. Additional second-stage payloads include Cobalt Strike beacons.</p>
<p><a href="https://bazaar.abuse.ch/sample/70eb84a6bce741ff988116434e4f531a724257185ab92df8fcfa90b3def6568f/">https://bazaar.abuse.ch/sample/70eb84a6bce741ff988116434e4f531a724257185ab92df8fcfa90b3def6568f/</a></p>
<p>Download zip &gt; .iso file (password protected)&gt; dll/lnk inside</p>
<p>Once the ISO is mounted, the .dll and .lnk are visible.</p>
<p><img alt="Untitled" src="/bumblebee/Untitled.png"></p>
<h3 id="lnk-analysis">
  LNK Analysis
  <a href="#lnk-analysis" class="h-anchor" aria-hidden="true">#</a>
</h3>
<p>Using LECmd.exe to analyze the LNK file. If on Linux, <a href="https://manpages.ubuntu.com/manpages/impish/man1/lnkinfo.1.html">Lnkinfo</a> gives a similar output.</p>
<p><img alt="Untitled" src="/bumblebee/Untitled2.png"></p>
<p><img alt="Untitled" src="/bumblebee/Untitled3.png"></p>
<p>Upon executing the LNK file, a <code>rundll32</code> process is created since that’s what was within the LNK file arguments. <code>/c start rundll32.exe 32de.dll,YTBSBbNTWU</code></p>
<p>In Process Hacker, the <code>rundll32</code> process reveals some IOCs.</p>
<p>First step is to view the actual process properties and go to the memory tab.</p>
<p><img alt="Untitled" src="/bumblebee/Untitled4.png"></p>
<p>Next, dump strings and filter for IPs using a regex pattern.</p>
<p><code>^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$</code></p>
<p><img alt="Untitled" src="/bumblebee/Untitled5.png"></p>
<p>Now for my lab, I didn’t receive any additional IOCs. All IPs above are from the loopback, ethernet and broadcast address. This may indicate the malware evades virtual machines or it’s user error and I have some settings to modify. But through the tweet below, additional IOCs were actually found.</p>
<p><a href="https://twitter.com/Max_Mal_/status/1516352309311246339">https://twitter.com/Max_Mal_/status/1516352309311246339</a></p>
<ul>
<li>199.80.55[.]44:443</li>
<li>209.141.59[.]96:433</li>
<li>23.106.160[.]120:433</li>
</ul>
<h3 id="dll-analysis">
  DLL Analysis
  <a href="#dll-analysis" class="h-anchor" aria-hidden="true">#</a>
</h3>
<p>Using <a href="https://www.mandiant.com/resources/capa-automatically-identify-malware-capabilities">CAPA</a>, some ATT&amp;CK tactics can be pulled.</p>
<p><img alt="Untitled" src="/bumblebee/Untitled6.png"></p>
<h3 id="intezer-endpoint-analysis">
  Intezer Endpoint Analysis
  <a href="#intezer-endpoint-analysis" class="h-anchor" aria-hidden="true">#</a>
</h3>
<p>As my IDA skills are weak, I couldn’t go much further into the DLL. Instead, I used Intezer’s <a href="https://analyze.intezer.com/endpoint-analyses">Endpoint scanner</a> to scan the machine to get useful information.</p>
<p>Some benefits of endpoint analysis:</p>
<ul>
<li><strong>Detection:</strong> Detect sophisticated threats running in-memory, including code injections, packed and multi-stage malware.</li>
<li><strong>Lightweight:</strong> A fast scanner that collects and analyzes only the relevant code in memory.</li>
<li><strong>Simple:</strong> On-demand scan (no installation is required), easily automated and accessible to analysts of all skill levels.</li>
</ul>
<p>After scanning the system:</p>
<p><img alt="Untitled" src="/bumblebee/Untitled7.png"></p>
<p>No surprise here, it’s infected with Bumblebee. But what is interesting is the additional malware found on the system including Khalesi. I was unfamiliar with Khalesi (besides watching Game of Thrones) but luckily you can explore malware within Intezer.</p>
<ul>
<li>Khaleis (Kpot, KPOT Stealer) is a “stealer” malware that focuses on exfiltrating account information and other data from web browsers, instant messengers, email, VPN, RDP, FTP, cryptocurrency, and gaming software.</li>
</ul>
<p>Scrolling down further, there’s a process tree showing what happened on the system.</p>
<p><img alt="Untitled" src="/bumblebee/Untitled8.png"></p>
<p>The command line section to the right correlates to what was seen in the LNK file properties. It executes <code>rundll32.exe 32de.dll,YTBSBbNTWU</code>. That second argument obviously does something, but I couldn’t see it. Luckily, Intezer shows it replaced the memory of a module in <code>c:\windows\winsxs\amd64_microsoft.windows.gdiplus_6595b64144ccf1df_1.1.22000.434_none_ce836c1412fb9b57\gdiplus.dll</code>.</p>
<p>After analyzing <code>gdiplus.dll</code>, it’s a trusted Microsoft file which would make sense given the malware overwrote the memory of that DLL. By viewing the code genes of Bumblebee under Intezer’s Code tab, it’s possible the malware is calling <code>VirtualProtectEx</code> to achieve this. It gets called again at <code>0x18003ba03</code>.</p>
<p><img alt="Untitled" src="/bumblebee/Untitled9.png"></p>
<p>From <a href="https://malapi.io/winapi/VirtualProtectEx">malapi.io</a>, <code>VirtualProtectEx</code> is often used by malware to modify memory protection in a remote process (often to allow write or execution).</p>
<p>To get more information on Bumblebee itself outside of endpoint scanning, it tags three related samples that can give greater detail as to what the malware fully accomplishes along with more IoCs.</p>
<p><img alt="Untitled" src="/bumblebee/Untitled10.png"></p>
<p>There’s a lot to be gathered from a suspicious endpoint and during my first test of the Endpoint Scanner, it serves as a great start. <code>32de.dll</code> appears to include a few methods of virtual machine / sandbox evasion, so that may be why the execution appears to stop here.</p>
<h3 id="references">
  References
  <a href="#references" class="h-anchor" aria-hidden="true">#</a>
</h3>
<ul>
<li><a href="https://elis531989.medium.com/the-chronicles-of-bumblebee-the-hook-the-bee-and-the-trickbot-connection-686379311056">https://elis531989.medium.com/the-chronicles-of-bumblebee-the-hook-the-bee-and-the-trickbot-connection-686379311056</a></li>
<li><a href="https://research.nccgroup.com/2022/04/29/adventures-in-the-land-of-bumblebee-a-new-malicious-loader/">https://research.nccgroup.com/2022/04/29/adventures-in-the-land-of-bumblebee-a-new-malicious-loader/</a></li>
<li><a href="https://github.com/Dump-GUY/Malware-analysis-and-Reverse-engineering/blob/main/kpot2/KPOT.md">https://github.com/Dump-GUY/Malware-analysis-and-Reverse-engineering/blob/main/kpot2/KPOT.md</a></li>
<li><a href="https://malapi.io/winapi/VirtualProtectEx">https://malapi.io/winapi/VirtualProtectEx</a></li>
</ul>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h"
              >Read other posts</span
            >
            <hr />
          </div>
          <div class="pagination__buttons">
            
              <span class="button previous">
                <a href="http://localhost:1313/posts/codesigningcerts/">
                  <span class="button__icon">←</span>
                  <span class="button__text">Abusing Code Signing Certificates</span>
                </a>
              </span>
            
            
              <span class="button next">
                <a href="http://localhost:1313/posts/cloudrecon/">
                  <span class="button__text">Cloud Recon</span>
                  <span class="button__icon">→</span>
                </a>
              </span>
            
          </div>
        </div>
      
    

    
      
        

      
    
  </article>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <a
  href="/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >Axelarator</span
    >
    <span class="logo__cursor"></span>
  
</a>

      <div class="copyright">
        <span>© 2024 Powered by <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a></span>
        <span><a href="https://github.com/panr/hugo-theme-hello-friend" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
    
  </div>
</footer>





<script type="text/javascript" src="/bundle.min.js"></script>


      
    </div>

    
  </body>
</html>
